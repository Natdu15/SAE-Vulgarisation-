
<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="icon" type="image/logo-sd.png" href="images/logo-sd.png">
    <link rel="stylesheet" href="css/choix.css">
    <title>Test de personnalité</title>
    <style>
        .question {
            text-align: center;
            margin: 20px 0;
            width: 100%;
            font-size: 1.5em;
        }
        .card-container {
            display: flex;
            justify-content: center;
            gap: 20px;
        }
        .card {
            width: 45%;
            max-width: 400px;
        }
    </style>
</head>
<body>

  <header>
    <h1>Test pour mieux vous connaître.</h1>
    <div class="categories">
      <div class="category selected" data-category="Matières préférées">Matières préférées</div>
      <div class="category" data-category="Compétences">Compétences</div>
      <div class="category" data-category="Vie étudiante">Vie étudiante</div>
      <div class="category" data-category="Ambition">Ambition</div>
      <div class="category" data-category="Profil étudiant">Profil étudiant</div>
    </div>
    <div id="roundIndicator">Round 1</div>
  </header>

  <h2 id="question" class="question"></h2>

  <div class="card-container">
    <div class="card" id="card1"></div>
    <div class="card" id="card2"></div>
  </div>

<script>
    document.addEventListener('DOMContentLoaded', () => {
    const categoriesData = {
      "Matières préférées": [
        { image: "https://source.unsplash.com/ykgLX_CwtDw", title: "Statistiques", description: "Étude des données numériques pour identifier des tendances et faire des prédictions.", score: 1 },
        { image: "https://source.unsplash.com/4hbJ-eymZ1o", title: "Programmation", description: "Apprentissage des langages informatiques pour créer des logiciels et automatiser des tâches.", score: 0 },
        { image: "https://source.unsplash.com/ykgLX_CwtDw", title: "Proba", description: "Compréhension des événements aléatoires et calcul des chances dans différentes situations.", score: 1 },
        { image: "https://source.unsplash.com/ykgLX_CwtDw", title: "Cryptologie", description: "Étude des techniques de sécurisation des données.", score: 0 },
        { image: "https://source.unsplash.com/ykgLX_CwtDw", title: "Algorithmes", description: "Développement de méthodes logiques pour résoudre des problèmes informatiques.", score: 0 },
        { image: "https://source.unsplash.com/ykgLX_CwtDw", title: "Prog statistiques", description: "Utilisation de langages pour analyser des données complexes.", score: 1 },
        { image: "https://source.unsplash.com/ykgLX_CwtDw", title: "Base de données", description: "Conception de systèmes pour gérer les données efficacement.", score: 0 },
        { image: "https://source.unsplash.com/ykgLX_CwtDw", title: "Cybersécurité", description: "Protection des systèmes contre les attaques.", score: 0 },
      ],
      "Compétences": [
        { image: "https://source.unsplash.com/ykgLX_CwtDw", title: "Développer un site Web", description: "Créer des sites internet accessibles et fonctionnels.", score: 0 },
        { image: "https://source.unsplash.com/ykgLX_CwtDw", title: "Créer une application mobile", description: "Développer des apps pour smartphones.", score: 0 },
        { image: "https://source.unsplash.com/ykgLX_CwtDw", title: "Créer un Dashboard de données", description: "Visualiser et interpréter des informations.", score: 1 },
        { image: "https://source.unsplash.com/ykgLX_CwtDw", title: "Créer un jeu vidéo", description: "Programmer des jeux interactifs.", score: 0 },
        { image: "https://source.unsplash.com/ykgLX_CwtDw", title: "Manipuler des bases de données", description: "Gérer des informations efficacement.", score: 1 },
        { image: "https://source.unsplash.com/ykgLX_CwtDw", title: "Analyser des graphiques", description: "Représenter des données graphiquement.", score: 1 },
        { image: "https://source.unsplash.com/ykgLX_CwtDw", title: "Déboguer un code", description: "Corriger les erreurs dans les programmes.", score: 0 },
        { image: "https://cdn.glitch.global/92297865-8423-4fe1-928c-10e45fd760d7/Dragon%20Ball%20Z.jpg?v=1749799157209", title: "Faire une enquête", description: "Analyser des informations pour des conclusions pertinentes.", score: 1 },   
      ],
      "Vie étudiante": [
        { image: "https://cdn.glitch.global/92297865-8423-4fe1-928c-10e45fd760d7/Kaguya-sama.jpg?v=1749799578073", title: "Participer aux soirées", description: "S’investir dans la vie sociale étudiante.", score: 1 },
        { image: "https://cdn.glitch.global/92297865-8423-4fe1-928c-10e45fd760d7/Kaguya-sama.jpg?v=1749799578073", title: "Rester chez soi", description: "Préférer les activités tranquilles à la maison.", score: 0 },
        { image: "https://cdn.glitch.global/92297865-8423-4fe1-928c-10e45fd760d7/Kaguya-sama.jpg?v=1749799578073", title: "Faire du sport", description: "Pratiquer une activité physique régulièrement.", score: 1 },
        { image: "https://cdn.glitch.global/92297865-8423-4fe1-928c-10e45fd760d7/Kaguya-sama.jpg?v=1749799578073", title: "Jouer aux jeux vidéo", description: "Se divertir avec des jeux stratégiques.", score: 0 },
        { image: "https://cdn.glitch.global/92297865-8423-4fe1-928c-10e45fd760d7/Kaguya-sama.jpg?v=1749799578073", title: "Travailler le week-end", description: "Consacrer du temps aux études.", score: 0 },
        { image: "https://cdn.glitch.global/92297865-8423-4fe1-928c-10e45fd760d7/Kaguya-sama.jpg?v=1749799578073", title: "Se reposer tranquillement", description: "Prendre du temps pour se détendre.", score: 0 },
        { image: "https://cdn.glitch.global/92297865-8423-4fe1-928c-10e45fd760d7/Kaguya-sama.jpg?v=1749799578073", title: "S’investir dans une association", description: "Participer à des projets collectifs.", score: 1 },
        { image: "https://cdn.glitch.global/92297865-8423-4fe1-928c-10e45fd760d7/Kaguya-sama.jpg?v=1749799578073", title: "Faire des projets personnels", description: "Développer ses propres idées.", score: 0 },
      ],
      "Ambition": [
        { image: "https://cdn.glitch.global/92297865-8423-4fe1-928c-10e45fd760d7/Death%20Note.jpg?v=1749799016263", title: "Trouver un emploi rapidement", description: "Intégrer le marché du travail vite.", score: 0 },
        { image: "https://cdn.glitch.global/92297865-8423-4fe1-928c-10e45fd760d7/Death%20Note.jpg?v=1749799016263", title: "Continuer les études", description: "Poursuivre un master ou école spécialisée.", score: 1 },
        { image: "https://cdn.glitch.global/92297865-8423-4fe1-928c-10e45fd760d7/Death%20Note.jpg?v=1749799016263", title: "Travailler dans une grande entreprise", description: "Rejoindre une structure organisée.", score: 0 },
        { image: "https://cdn.glitch.global/92297865-8423-4fe1-928c-10e45fd760d7/Death%20Note.jpg?v=1749799016263", title: "Créer sa propre entreprise", description: "Monter un projet entrepreneurial.", score: 1 },
        { image: "https://cdn.glitch.global/92297865-8423-4fe1-928c-10e45fd760d7/Death%20Note.jpg?v=1749799016263", title: "Faire un BUT/Master/École d’ingénieur", description: "Obtenir un diplôme supérieur.", score: 1 },
        { image: "https://cdn.glitch.global/92297865-8423-4fe1-928c-10e45fd760d7/Death%20Note.jpg?v=1749799016263", title: "Arrêter l’école", description: "Entrer dans la vie active.", score: 0 },
        { image: "https://cdn.glitch.global/92297865-8423-4fe1-928c-10e45fd760d7/Death%20Note.jpg?v=1749799016263", title: "Partir à l’étranger", description: "Vivre une expérience internationale.", score: 1 },
        { image: "https://cdn.glitch.global/92297865-8423-4fe1-928c-10e45fd760d7/Death%20Note.jpg?v=1749799016263", title: "Rester travailler localement", description: "Opportunités proches de chez soi.", score: 0 },
      ],
      "Profil étudiant": [
        { image: "https://cdn.glitch.global/753b2206-8aec-499d-95ff-df1dc687ac0e/Solo%20Leveling.jpg?v=1749755167270", title: "Solo Leveling", description: "Sung Jin-woo, le plus faible des chasseurs, devient le plus puissant grâce à un journal de quête." },
        { image: "https://cdn.glitch.global/753b2206-8aec-499d-95ff-df1dc687ac0e/Solo%20Leveling.jpg?v=1749755167270", title: "Solo Leveling", description: "Sung Jin-woo, le plus faible des chasseurs, devient le plus puissant grâce à un journal de quête." },
        { image: "https://cdn.glitch.global/753b2206-8aec-499d-95ff-df1dc687ac0e/Solo%20Leveling.jpg?v=1749755167270", title: "Solo Leveling", description: "Sung Jin-woo, le plus faible des chasseurs, devient le plus puissant grâce à un journal de quête." },
        { image: "https://cdn.glitch.global/753b2206-8aec-499d-95ff-df1dc687ac0e/Solo%20Leveling.jpg?v=1749755167270", title: "Solo Leveling", description: "Sung Jin-woo, le plus faible des chasseurs, devient le plus puissant grâce à un journal de quête." },
        { image: "https://cdn.glitch.global/753b2206-8aec-499d-95ff-df1dc687ac0e/Solo%20Leveling.jpg?v=1749755167270", title: "Solo Leveling", description: "Sung Jin-woo, le plus faible des chasseurs, devient le plus puissant grâce à un journal de quête." },
        { image: "https://cdn.glitch.global/753b2206-8aec-499d-95ff-df1dc687ac0e/Solo%20Leveling.jpg?v=1749755167270", title: "Solo Leveling", description: "Sung Jin-woo, le plus faible des chasseurs, devient le plus puissant grâce à un journal de quête." },
        { image: "https://cdn.glitch.global/753b2206-8aec-499d-95ff-df1dc687ac0e/Solo%20Leveling.jpg?v=1749755167270", title: "Solo Leveling", description: "Sung Jin-woo, le plus faible des chasseurs, devient le plus puissant grâce à un journal de quête." },
        { image: "https://cdn.glitch.global/753b2206-8aec-499d-95ff-df1dc687ac0e/Solo%20Leveling.jpg?v=1749755167270", title: "Solo Leveling", description: "Sung Jin-woo, le plus faible des chasseurs, devient le plus puissant grâce à un journal de quête." },
        { image: "https://cdn.glitch.global/753b2206-8aec-499d-95ff-df1dc687ac0e/Solo%20Leveling.jpg?v=1749755167270", title: "Solo Leveling", description: "Sung Jin-woo, le plus faible des chasseurs, devient le plus puissant grâce à un journal de quête." },
      ]
    };

    const questions = {
      "Matières préférées": "Quelle est votre matière préférée ?",
      "Compétences": "Quelle compétence préférez-vous ?",
      "Vie étudiante": "Quelle est votre activité préférée dans la vie étudiante ?",
      "Ambition": "Quelle est votre ambition ?",
      "Profil étudiant": "Quel profil étudiant vous correspond le mieux ?"
    };

    const profiles = {
      "Matières préférées": (score) => {
        if (score > 5) return "Vous êtes passionné par les mathématiques et les statistiques !";
        else if (score >= 2 && score <= 5) return "Vous avez un équilibre entre maths et informatique pratique.";
        else return "Vous êtes orienté vers le développement et la sécurité informatique.";
      },
      "Compétences": (score) => {
        if (score > 5) return "Vous excellez dans l'analyse de données !";
        else if (score >= 2 && score <= 5) return "Vous avez des compétences mixtes en dev et data.";
        else return "Vous êtes un développeur pur !";
      },
      "Vie étudiante": (score) => {
        if (score > 5) return "Vous êtes un super fêtard !";
        else if (score >= 2 && score <= 5) return "Vous aimez sortir de temps en temps.";
        else return "Vous ne sortez pratiquement jamais.";
      },
      "Ambition": (score) => {
        if (score > 5) return "Vous êtes très ambitieux !";
        else if (score >= 2 && score <= 5) return "Vous avez une ambition modérée.";
        else return "Vous préférez la stabilité.";
      },
      "Profil étudiant": null
    };

    let selectedCategory = "Matières préférées";
    let currentRound = [];
    let winners = [];
    let pairIndex = 0;
    let roundNumber = 1;
    let totalRounds = 0;
    let totalScore = 0;

    const card1 = document.getElementById('card1');
    const card2 = document.getElementById('card2');
    const roundIndicator = document.getElementById('roundIndicator');
    const categoryElements = document.querySelectorAll('.category');
    const cardContainer = document.querySelector('.card-container');

    function normalizeCategory(cat) {
      return cat.trim().toLowerCase();
    }

    function shuffleArray(array) {
      for (let i = array.length - 1; i > 0; i--) {
        const j = Math.floor(Math.random() * (i + 1));
        [array[i], array[j]] = [array[j], array[i]];
      }
    }

    function updateRoundIndicator() {
      roundIndicator.textContent = `Round ${roundNumber} sur ${totalRounds} (${currentRound.length} participants)`;
    }

    async function loadPair() {
      if (pairIndex < currentRound.length - 1) {
        const leftManga = currentRound[pairIndex];
        const rightManga = currentRound[pairIndex + 1];
        card1.innerHTML = `
          <img src="${leftManga.image}" alt="${leftManga.title}">
          <div class="info">
            <h2>${leftManga.title}</h2>
            <p>${leftManga.description}</p>
          </div>
        `;
        card2.innerHTML = `
          <img src="${rightManga.image}" alt="${rightManga.title}">
          <div class="info">
            <h2>${rightManga.title}</h2>
            <p>${rightManga.description}</p>
          </div>
        `;
      } else {
        if (winners.length === 1) {
          const profileFunc = profiles[selectedCategory];
          let resultHTML;
          if (profileFunc) {
            const profileText = profileFunc(totalScore);
            resultHTML = `
              <h1>🏆 Résultat du Test 🏆</h1>
              <h2>${profileText}</h2>
              <p>Score total : ${totalScore}</p>
              <p>Votre choix final : ${winners[0].title}</p>
              <img src="${winners[0].image}" alt="${winners[0].title}" class="winner-img">
              <p>${winners[0].description}</p>
            `;
          } else {
            resultHTML = `
              <h1>🏆 Gagnant 🏆</h1>
              <h2>${winners[0].title}</h2>
              <img src="${winners[0].image}" alt="${winners[0].title}" class="winner-img">
              <p>${winners[0].description}</p>
            `;
          }

          document.body.classList.add('victory-background');
          document.body.innerHTML = `
            <button class="btn-finish">← Retour immédiat</button>
            <div class="winner">
              ${resultHTML}
              <p class="compte-rebours">Retour à l'accueil dans <span id="countdown">10</span> secondes...</p>
              <button id="btn-stats" class="gradient-button">📊 Accéder aux Statistiques</button>
            </div>
          `;

          document.getElementById('btn-stats').addEventListener('click', () => {
            window.location.href = 'statistiques.html';
          });

          let seconds = 10;
          const countdownEl = document.getElementById("countdown");
          const timer = setInterval(() => {
            seconds--;
            countdownEl.textContent = seconds;
            if (seconds <= 0) {
              clearInterval(timer);
              window.location.href = "Manga.html";
            }
          }, 1000);

          document.querySelector('.btn-finish').addEventListener('click', () => {
            clearInterval(timer);
            window.location.href = "Manga.html";
          });
        } else {
          currentRound = winners;
          winners = [];
          pairIndex = 0;
          roundNumber++;
          shuffleArray(currentRound);
          updateRoundIndicator();
          loadPair();
        }
      }
    }

    function chooseWinner(index) {
      const chosen = currentRound[pairIndex + index];
      totalScore += chosen.score || 0;
      winners.push(chosen);
      pairIndex += 2;
      loadPair();
    }

    function initializeTournament() {
      const keys = Object.keys(categoriesData);
      const foundKey = keys.find(k => normalizeCategory(k) === normalizeCategory(selectedCategory));

      if (foundKey && categoriesData[foundKey].length > 0) {
        currentRound = [...categoriesData[foundKey]];
        totalRounds = Math.log2(currentRound.length);
        if (!Number.isInteger(totalRounds)) {
          const validLength = Math.pow(2, Math.floor(totalRounds));
          currentRound = currentRound.slice(0, validLength);
          totalRounds = Math.floor(totalRounds);
        }
        shuffleArray(currentRound);
        winners = [];
        pairIndex = 0;
        roundNumber = 1;
        totalScore = 0;
        updateRoundIndicator();
        document.getElementById('question').textContent = questions[foundKey] || "Choisissez votre préféré.";
        loadPair();
      } else {
        cardContainer.innerHTML = `<div class="winner"><h2>Aucun choix pour cette catégorie.</h2></div>`;
        roundIndicator.textContent = '';
      }
    }

    categoryElements.forEach(elem => {
      elem.addEventListener('click', () => {
        categoryElements.forEach(e => e.classList.remove('selected'));
        elem.classList.add('selected');
        selectedCategory = elem.getAttribute('data-category');
        initializeTournament();
      });
    });

    const urlParams = new URLSearchParams(window.location.search);
    const categoryParam = urlParams.get('category');
    if (categoryParam) {
      selectedCategory = categoryParam;
      categoryElements.forEach(e => e.classList.remove('selected'));
      const targetCat = Array.from(categoryElements).find(c => normalizeCategory(c.dataset.category) === normalizeCategory(categoryParam));
      if (targetCat) targetCat.classList.add('selected');
    }

    card1.addEventListener('click', () => chooseWinner(0));
    card2.addEventListener('click', () => chooseWinner(1));

    initializeTournament();
});
  </script>
  </body>
  </html>
