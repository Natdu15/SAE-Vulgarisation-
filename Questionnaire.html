
<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="icon" type="image/logo-sd.png" href="images/logo-sd.png">
    <link rel="stylesheet" href="css/choix.css">
    <title>Test de personnalit√©</title>
    <style>
        .question {
            text-align: center;
            margin: 20px 0;
            width: 100%;
            font-size: 1.5em;
        }
        .card-container {
            display: flex;
            justify-content: center;
            gap: 20px;
        }
        .card {
            width: 45%;
            max-width: 400px;
        }
    </style>
</head>
<body>

  <header>
    <h1>Test pour mieux vous conna√Ætre.</h1>
    <div class="categories">
      <div class="category selected" data-category="Mati√®res pr√©f√©r√©es">Mati√®res pr√©f√©r√©es</div>
      <div class="category" data-category="Comp√©tences">Comp√©tences</div>
      <div class="category" data-category="Vie √©tudiante">Vie √©tudiante</div>
      <div class="category" data-category="Ambition">Ambition</div>
      <div class="category" data-category="Profil √©tudiant">Profil √©tudiant</div>
    </div>
    <div id="roundIndicator">Round 1</div>
  </header>

  <h2 id="question" class="question"></h2>

  <div class="card-container">
    <div class="card" id="card1"></div>
    <div class="card" id="card2"></div>
  </div>

<script>
    document.addEventListener('DOMContentLoaded', () => {
    const categoriesData = {
      "Mati√®res pr√©f√©r√©es": [
        { image: "https://source.unsplash.com/ykgLX_CwtDw", title: "Statistiques", description: "√âtude des donn√©es num√©riques pour identifier des tendances et faire des pr√©dictions.", score: 1 },
        { image: "https://source.unsplash.com/4hbJ-eymZ1o", title: "Programmation", description: "Apprentissage des langages informatiques pour cr√©er des logiciels et automatiser des t√¢ches.", score: 0 },
        { image: "https://source.unsplash.com/ykgLX_CwtDw", title: "Proba", description: "Compr√©hension des √©v√©nements al√©atoires et calcul des chances dans diff√©rentes situations.", score: 1 },
        { image: "https://source.unsplash.com/ykgLX_CwtDw", title: "Cryptologie", description: "√âtude des techniques de s√©curisation des donn√©es.", score: 0 },
        { image: "https://source.unsplash.com/ykgLX_CwtDw", title: "Algorithmes", description: "D√©veloppement de m√©thodes logiques pour r√©soudre des probl√®mes informatiques.", score: 0 },
        { image: "https://source.unsplash.com/ykgLX_CwtDw", title: "Prog statistiques", description: "Utilisation de langages pour analyser des donn√©es complexes.", score: 1 },
        { image: "https://source.unsplash.com/ykgLX_CwtDw", title: "Base de donn√©es", description: "Conception de syst√®mes pour g√©rer les donn√©es efficacement.", score: 0 },
        { image: "https://source.unsplash.com/ykgLX_CwtDw", title: "Cybers√©curit√©", description: "Protection des syst√®mes contre les attaques.", score: 0 },
      ],
      "Comp√©tences": [
        { image: "https://source.unsplash.com/ykgLX_CwtDw", title: "D√©velopper un site Web", description: "Cr√©er des sites internet accessibles et fonctionnels.", score: 0 },
        { image: "https://source.unsplash.com/ykgLX_CwtDw", title: "Cr√©er une application mobile", description: "D√©velopper des apps pour smartphones.", score: 0 },
        { image: "https://source.unsplash.com/ykgLX_CwtDw", title: "Cr√©er un Dashboard de donn√©es", description: "Visualiser et interpr√©ter des informations.", score: 1 },
        { image: "https://source.unsplash.com/ykgLX_CwtDw", title: "Cr√©er un jeu vid√©o", description: "Programmer des jeux interactifs.", score: 0 },
        { image: "https://source.unsplash.com/ykgLX_CwtDw", title: "Manipuler des bases de donn√©es", description: "G√©rer des informations efficacement.", score: 1 },
        { image: "https://source.unsplash.com/ykgLX_CwtDw", title: "Analyser des graphiques", description: "Repr√©senter des donn√©es graphiquement.", score: 1 },
        { image: "https://source.unsplash.com/ykgLX_CwtDw", title: "D√©boguer un code", description: "Corriger les erreurs dans les programmes.", score: 0 },
        { image: "https://cdn.glitch.global/92297865-8423-4fe1-928c-10e45fd760d7/Dragon%20Ball%20Z.jpg?v=1749799157209", title: "Faire une enqu√™te", description: "Analyser des informations pour des conclusions pertinentes.", score: 1 },   
      ],
      "Vie √©tudiante": [
        { image: "https://cdn.glitch.global/92297865-8423-4fe1-928c-10e45fd760d7/Kaguya-sama.jpg?v=1749799578073", title: "Participer aux soir√©es", description: "S‚Äôinvestir dans la vie sociale √©tudiante.", score: 1 },
        { image: "https://cdn.glitch.global/92297865-8423-4fe1-928c-10e45fd760d7/Kaguya-sama.jpg?v=1749799578073", title: "Rester chez soi", description: "Pr√©f√©rer les activit√©s tranquilles √† la maison.", score: 0 },
        { image: "https://cdn.glitch.global/92297865-8423-4fe1-928c-10e45fd760d7/Kaguya-sama.jpg?v=1749799578073", title: "Faire du sport", description: "Pratiquer une activit√© physique r√©guli√®rement.", score: 1 },
        { image: "https://cdn.glitch.global/92297865-8423-4fe1-928c-10e45fd760d7/Kaguya-sama.jpg?v=1749799578073", title: "Jouer aux jeux vid√©o", description: "Se divertir avec des jeux strat√©giques.", score: 0 },
        { image: "https://cdn.glitch.global/92297865-8423-4fe1-928c-10e45fd760d7/Kaguya-sama.jpg?v=1749799578073", title: "Travailler le week-end", description: "Consacrer du temps aux √©tudes.", score: 0 },
        { image: "https://cdn.glitch.global/92297865-8423-4fe1-928c-10e45fd760d7/Kaguya-sama.jpg?v=1749799578073", title: "Se reposer tranquillement", description: "Prendre du temps pour se d√©tendre.", score: 0 },
        { image: "https://cdn.glitch.global/92297865-8423-4fe1-928c-10e45fd760d7/Kaguya-sama.jpg?v=1749799578073", title: "S‚Äôinvestir dans une association", description: "Participer √† des projets collectifs.", score: 1 },
        { image: "https://cdn.glitch.global/92297865-8423-4fe1-928c-10e45fd760d7/Kaguya-sama.jpg?v=1749799578073", title: "Faire des projets personnels", description: "D√©velopper ses propres id√©es.", score: 0 },
      ],
      "Ambition": [
        { image: "https://cdn.glitch.global/92297865-8423-4fe1-928c-10e45fd760d7/Death%20Note.jpg?v=1749799016263", title: "Trouver un emploi rapidement", description: "Int√©grer le march√© du travail vite.", score: 0 },
        { image: "https://cdn.glitch.global/92297865-8423-4fe1-928c-10e45fd760d7/Death%20Note.jpg?v=1749799016263", title: "Continuer les √©tudes", description: "Poursuivre un master ou √©cole sp√©cialis√©e.", score: 1 },
        { image: "https://cdn.glitch.global/92297865-8423-4fe1-928c-10e45fd760d7/Death%20Note.jpg?v=1749799016263", title: "Travailler dans une grande entreprise", description: "Rejoindre une structure organis√©e.", score: 0 },
        { image: "https://cdn.glitch.global/92297865-8423-4fe1-928c-10e45fd760d7/Death%20Note.jpg?v=1749799016263", title: "Cr√©er sa propre entreprise", description: "Monter un projet entrepreneurial.", score: 1 },
        { image: "https://cdn.glitch.global/92297865-8423-4fe1-928c-10e45fd760d7/Death%20Note.jpg?v=1749799016263", title: "Faire un BUT/Master/√âcole d‚Äôing√©nieur", description: "Obtenir un dipl√¥me sup√©rieur.", score: 1 },
        { image: "https://cdn.glitch.global/92297865-8423-4fe1-928c-10e45fd760d7/Death%20Note.jpg?v=1749799016263", title: "Arr√™ter l‚Äô√©cole", description: "Entrer dans la vie active.", score: 0 },
        { image: "https://cdn.glitch.global/92297865-8423-4fe1-928c-10e45fd760d7/Death%20Note.jpg?v=1749799016263", title: "Partir √† l‚Äô√©tranger", description: "Vivre une exp√©rience internationale.", score: 1 },
        { image: "https://cdn.glitch.global/92297865-8423-4fe1-928c-10e45fd760d7/Death%20Note.jpg?v=1749799016263", title: "Rester travailler localement", description: "Opportunit√©s proches de chez soi.", score: 0 },
      ],
      "Profil √©tudiant": [
        { image: "https://cdn.glitch.global/753b2206-8aec-499d-95ff-df1dc687ac0e/Solo%20Leveling.jpg?v=1749755167270", title: "Solo Leveling", description: "Sung Jin-woo, le plus faible des chasseurs, devient le plus puissant gr√¢ce √† un journal de qu√™te." },
        { image: "https://cdn.glitch.global/753b2206-8aec-499d-95ff-df1dc687ac0e/Solo%20Leveling.jpg?v=1749755167270", title: "Solo Leveling", description: "Sung Jin-woo, le plus faible des chasseurs, devient le plus puissant gr√¢ce √† un journal de qu√™te." },
        { image: "https://cdn.glitch.global/753b2206-8aec-499d-95ff-df1dc687ac0e/Solo%20Leveling.jpg?v=1749755167270", title: "Solo Leveling", description: "Sung Jin-woo, le plus faible des chasseurs, devient le plus puissant gr√¢ce √† un journal de qu√™te." },
        { image: "https://cdn.glitch.global/753b2206-8aec-499d-95ff-df1dc687ac0e/Solo%20Leveling.jpg?v=1749755167270", title: "Solo Leveling", description: "Sung Jin-woo, le plus faible des chasseurs, devient le plus puissant gr√¢ce √† un journal de qu√™te." },
        { image: "https://cdn.glitch.global/753b2206-8aec-499d-95ff-df1dc687ac0e/Solo%20Leveling.jpg?v=1749755167270", title: "Solo Leveling", description: "Sung Jin-woo, le plus faible des chasseurs, devient le plus puissant gr√¢ce √† un journal de qu√™te." },
        { image: "https://cdn.glitch.global/753b2206-8aec-499d-95ff-df1dc687ac0e/Solo%20Leveling.jpg?v=1749755167270", title: "Solo Leveling", description: "Sung Jin-woo, le plus faible des chasseurs, devient le plus puissant gr√¢ce √† un journal de qu√™te." },
        { image: "https://cdn.glitch.global/753b2206-8aec-499d-95ff-df1dc687ac0e/Solo%20Leveling.jpg?v=1749755167270", title: "Solo Leveling", description: "Sung Jin-woo, le plus faible des chasseurs, devient le plus puissant gr√¢ce √† un journal de qu√™te." },
        { image: "https://cdn.glitch.global/753b2206-8aec-499d-95ff-df1dc687ac0e/Solo%20Leveling.jpg?v=1749755167270", title: "Solo Leveling", description: "Sung Jin-woo, le plus faible des chasseurs, devient le plus puissant gr√¢ce √† un journal de qu√™te." },
        { image: "https://cdn.glitch.global/753b2206-8aec-499d-95ff-df1dc687ac0e/Solo%20Leveling.jpg?v=1749755167270", title: "Solo Leveling", description: "Sung Jin-woo, le plus faible des chasseurs, devient le plus puissant gr√¢ce √† un journal de qu√™te." },
      ]
    };

    const questions = {
      "Mati√®res pr√©f√©r√©es": "Quelle est votre mati√®re pr√©f√©r√©e ?",
      "Comp√©tences": "Quelle comp√©tence pr√©f√©rez-vous ?",
      "Vie √©tudiante": "Quelle est votre activit√© pr√©f√©r√©e dans la vie √©tudiante ?",
      "Ambition": "Quelle est votre ambition ?",
      "Profil √©tudiant": "Quel profil √©tudiant vous correspond le mieux ?"
    };

    const profiles = {
      "Mati√®res pr√©f√©r√©es": (score) => {
        if (score > 5) return "Vous √™tes passionn√© par les math√©matiques et les statistiques !";
        else if (score >= 2 && score <= 5) return "Vous avez un √©quilibre entre maths et informatique pratique.";
        else return "Vous √™tes orient√© vers le d√©veloppement et la s√©curit√© informatique.";
      },
      "Comp√©tences": (score) => {
        if (score > 5) return "Vous excellez dans l'analyse de donn√©es !";
        else if (score >= 2 && score <= 5) return "Vous avez des comp√©tences mixtes en dev et data.";
        else return "Vous √™tes un d√©veloppeur pur !";
      },
      "Vie √©tudiante": (score) => {
        if (score > 5) return "Vous √™tes un super f√™tard !";
        else if (score >= 2 && score <= 5) return "Vous aimez sortir de temps en temps.";
        else return "Vous ne sortez pratiquement jamais.";
      },
      "Ambition": (score) => {
        if (score > 5) return "Vous √™tes tr√®s ambitieux !";
        else if (score >= 2 && score <= 5) return "Vous avez une ambition mod√©r√©e.";
        else return "Vous pr√©f√©rez la stabilit√©.";
      },
      "Profil √©tudiant": null
    };

    let selectedCategory = "Mati√®res pr√©f√©r√©es";
    let currentRound = [];
    let winners = [];
    let pairIndex = 0;
    let roundNumber = 1;
    let totalRounds = 0;
    let totalScore = 0;

    const card1 = document.getElementById('card1');
    const card2 = document.getElementById('card2');
    const roundIndicator = document.getElementById('roundIndicator');
    const categoryElements = document.querySelectorAll('.category');
    const cardContainer = document.querySelector('.card-container');

    function normalizeCategory(cat) {
      return cat.trim().toLowerCase();
    }

    function shuffleArray(array) {
      for (let i = array.length - 1; i > 0; i--) {
        const j = Math.floor(Math.random() * (i + 1));
        [array[i], array[j]] = [array[j], array[i]];
      }
    }

    function updateRoundIndicator() {
      roundIndicator.textContent = `Round ${roundNumber} sur ${totalRounds} (${currentRound.length} participants)`;
    }

    async function loadPair() {
      if (pairIndex < currentRound.length - 1) {
        const leftManga = currentRound[pairIndex];
        const rightManga = currentRound[pairIndex + 1];
        card1.innerHTML = `
          <img src="${leftManga.image}" alt="${leftManga.title}">
          <div class="info">
            <h2>${leftManga.title}</h2>
            <p>${leftManga.description}</p>
          </div>
        `;
        card2.innerHTML = `
          <img src="${rightManga.image}" alt="${rightManga.title}">
          <div class="info">
            <h2>${rightManga.title}</h2>
            <p>${rightManga.description}</p>
          </div>
        `;
      } else {
        if (winners.length === 1) {
          const profileFunc = profiles[selectedCategory];
          let resultHTML;
          if (profileFunc) {
            const profileText = profileFunc(totalScore);
            resultHTML = `
              <h1>üèÜ R√©sultat du Test üèÜ</h1>
              <h2>${profileText}</h2>
              <p>Score total : ${totalScore}</p>
              <p>Votre choix final : ${winners[0].title}</p>
              <img src="${winners[0].image}" alt="${winners[0].title}" class="winner-img">
              <p>${winners[0].description}</p>
            `;
          } else {
            resultHTML = `
              <h1>üèÜ Gagnant üèÜ</h1>
              <h2>${winners[0].title}</h2>
              <img src="${winners[0].image}" alt="${winners[0].title}" class="winner-img">
              <p>${winners[0].description}</p>
            `;
          }

          document.body.classList.add('victory-background');
          document.body.innerHTML = `
            <button class="btn-finish">‚Üê Retour imm√©diat</button>
            <div class="winner">
              ${resultHTML}
              <p class="compte-rebours">Retour √† l'accueil dans <span id="countdown">10</span> secondes...</p>
              <button id="btn-stats" class="gradient-button">üìä Acc√©der aux Statistiques</button>
            </div>
          `;

          document.getElementById('btn-stats').addEventListener('click', () => {
            window.location.href = 'statistiques.html';
          });

          let seconds = 10;
          const countdownEl = document.getElementById("countdown");
          const timer = setInterval(() => {
            seconds--;
            countdownEl.textContent = seconds;
            if (seconds <= 0) {
              clearInterval(timer);
              window.location.href = "Manga.html";
            }
          }, 1000);

          document.querySelector('.btn-finish').addEventListener('click', () => {
            clearInterval(timer);
            window.location.href = "Manga.html";
          });
        } else {
          currentRound = winners;
          winners = [];
          pairIndex = 0;
          roundNumber++;
          shuffleArray(currentRound);
          updateRoundIndicator();
          loadPair();
        }
      }
    }

    function chooseWinner(index) {
      const chosen = currentRound[pairIndex + index];
      totalScore += chosen.score || 0;
      winners.push(chosen);
      pairIndex += 2;
      loadPair();
    }

    function initializeTournament() {
      const keys = Object.keys(categoriesData);
      const foundKey = keys.find(k => normalizeCategory(k) === normalizeCategory(selectedCategory));

      if (foundKey && categoriesData[foundKey].length > 0) {
        currentRound = [...categoriesData[foundKey]];
        totalRounds = Math.log2(currentRound.length);
        if (!Number.isInteger(totalRounds)) {
          const validLength = Math.pow(2, Math.floor(totalRounds));
          currentRound = currentRound.slice(0, validLength);
          totalRounds = Math.floor(totalRounds);
        }
        shuffleArray(currentRound);
        winners = [];
        pairIndex = 0;
        roundNumber = 1;
        totalScore = 0;
        updateRoundIndicator();
        document.getElementById('question').textContent = questions[foundKey] || "Choisissez votre pr√©f√©r√©.";
        loadPair();
      } else {
        cardContainer.innerHTML = `<div class="winner"><h2>Aucun choix pour cette cat√©gorie.</h2></div>`;
        roundIndicator.textContent = '';
      }
    }

    categoryElements.forEach(elem => {
      elem.addEventListener('click', () => {
        categoryElements.forEach(e => e.classList.remove('selected'));
        elem.classList.add('selected');
        selectedCategory = elem.getAttribute('data-category');
        initializeTournament();
      });
    });

    const urlParams = new URLSearchParams(window.location.search);
    const categoryParam = urlParams.get('category');
    if (categoryParam) {
      selectedCategory = categoryParam;
      categoryElements.forEach(e => e.classList.remove('selected'));
      const targetCat = Array.from(categoryElements).find(c => normalizeCategory(c.dataset.category) === normalizeCategory(categoryParam));
      if (targetCat) targetCat.classList.add('selected');
    }

    card1.addEventListener('click', () => chooseWinner(0));
    card2.addEventListener('click', () => chooseWinner(1));

    initializeTournament();
});
  </script>
  </body>
  </html>
