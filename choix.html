<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="icon" type="logo-sd.png" href="logo-sd.png">
    <link rel="stylesheet" href="css/choix.css">
    <title>Test de personalit√©</title>
</head>
<body>

  <header>
    <h1>Test pour mieux vous conna√Ætre.</h1>
    <div class="categories">
      <div class="category selected" data-category="All-Time">Profil √©tudiant</div>
      <div class="category" data-category="Sh≈çnen">Comp√©tences</div>
      <div class="category" data-category="Sh≈çjo">Vie √©tudiante</div>
      <div class="category" data-category="Seinen">Ambition</div>
      <div class="category" data-category="Manhwa">Mati√®res pr√©f√©r√©es</div>
    </div>
    <div id="roundIndicator">Round 1</div>
  </header>

  <div class="card-container">
    <div class="card" id="card1"></div>
    <div class="card" id="card2"></div>
  </div>

  <script>
    // Donn√©es pour les diff√©rentes cat√©gories
    document.addEventListener('DOMContentLoaded', () => {

    const categoriesData = {
      "Mati√®re √©tudi√©s": [
        { image: "https://unsplash.com/fr/photos/une-personne-ecrit-sur-un-morceau-de-papier-ykgLX_CwtDw", title: "Statistiques", description: "√âtude des donn√©es num√©riques pour identifier des tendances et faire des pr√©dictions." },
        { image: "https://unsplash.com/fr/photos/lignes-de-codes-html-4hbJ-eymZ1o", title: "Programmation", description: "Apprentissage des langages informatiques pour cr√©er des logiciels et automatiser des t√¢ches." },
        { image: "https://unsplash.com/fr/photos/une-personne-ecrit-sur-un-morceau-de-papier-ykgLX_CwtDw", title: "Proba", description: "Compr√©hension des √©v√©nements al√©atoires et calcul des chances dans diff√©rentes situations." },
        { image: "https://unsplash.com/fr/photos/une-personne-ecrit-sur-un-morceau-de-papier-ykgLX_CwtDw", title: "Cryptologie", description: "√âtude des donn√©es num√©riques pour identifier des tendances et faire des pr√©dictions." },
        { image: "https://unsplash.com/fr/photos/une-personne-ecrit-sur-un-morceau-de-papier-ykgLX_CwtDw", title: "Algorithmes", description: "D√©veloppement de m√©thodes et proc√©dures logiques pour r√©soudre des probl√®mes informatiques." },
        { image: "https://unsplash.com/fr/photos/une-personne-ecrit-sur-un-morceau-de-papier-ykgLX_CwtDw", title: "Prog statistiques", description: "Utilisation de langages pour analyser et mod√©liser des donn√©es complexes." },
        { image: "https://unsplash.com/fr/photos/une-personne-ecrit-sur-un-morceau-de-papier-ykgLX_CwtDw", title: "Base de donn√©es", description: "Conception et manipulation de syst√®mes pour stocker et r√©cup√©rer des donn√©es efficacement." },
        { image: "https://unsplash.com/fr/photos/une-personne-ecrit-sur-un-morceau-de-papier-ykgLX_CwtDw", title: "Cybers√©curit√©", description: "Protection des syst√®mes et des donn√©es contre les attaques et les intrusions." },

      ],
      "Comp√©tences": [
        { image: "https://unsplash.com/fr/photos/une-personne-ecrit-sur-un-morceau-de-papier-ykgLX_CwtDw", title: "D√©velopper un site Web", description: "Cr√©er et maintenir des sites internet accessibles et fonctionnels." },
        { image: "https://unsplash.com/fr/photos/une-personne-ecrit-sur-un-morceau-de-papier-ykgLX_CwtDw", title: "Cr√©er une application mobile", description: "D√©velopper des apps pour smartphones et tablettes." },
        { image: "https://unsplash.com/fr/photos/une-personne-ecrit-sur-un-morceau-de-papier-ykgLX_CwtDw", title: "Cr√©er un Dashboard de donn√©es", description: "Construire des tableaux de bord pour visualiser et interpr√©ter les informations." },
        { image: "https://unsplash.com/fr/photos/une-personne-ecrit-sur-un-morceau-de-papier-ykgLX_CwtDw", title: "Cr√©er un jeu vid√©os", description: "Concevoir et programmer des jeux interactifs pour diff√©rents supports." },
        { image: "https://unsplash.com/fr/photos/une-personne-ecrit-sur-un-morceau-de-papier-ykgLX_CwtDw", title: "Manipuler des bases de donn√©es", description: "Rechercher, organiser et g√©rer des informations de mani√®re efficace." },
        { image: "https://unsplash.com/fr/photos/une-personne-ecrit-sur-un-morceau-de-papier-ykgLX_CwtDw", title: "Analyser des graphiques", description: "Repr√©senter des donn√©es sous forme graphique pour mieux les comprendre." },
        { image: "https://unsplash.com/fr/photos/une-personne-ecrit-sur-un-morceau-de-papier-ykgLX_CwtDw", title: "D√©boguer un code", description: "Identifier et corriger les erreurs dans des programmes informatiques." },
        { image: "https://cdn.glitch.global/92297865-8423-4fe1-928c-10e45fd760d7/Dragon%20Ball%20Z.jpg?v=1749799157209", title: "Faire une enqu√™te", description: "Collecter et analyser des informations pour en tirer des conclusions pertinentes." },   
      ],
      "Vie √©tudiante": [
        { image: "https://cdn.glitch.global/92297865-8423-4fe1-928c-10e45fd760d7/Kaguya-sama.jpg?v=1749799578073", title: "Kaguya-sama:Love is War", description: "Deux g√©nies amoureux se livrent une guerre psychologique pour ne pas avouer en premier." },
          { image: "https://cdn.glitch.global/92297865-8423-4fe1-928c-10e45fd760d7/Kaguya-sama.jpg?v=1749799578073", title: "Kaguya-sama:Love is War", description: "Deux g√©nies amoureux se livrent une guerre psychologique pour ne pas avouer en premier." },
          { image: "https://cdn.glitch.global/92297865-8423-4fe1-928c-10e45fd760d7/Kaguya-sama.jpg?v=1749799578073", title: "Kaguya-sama:Love is War", description: "Deux g√©nies amoureux se livrent une guerre psychologique pour ne pas avouer en premier." },
          { image: "https://cdn.glitch.global/92297865-8423-4fe1-928c-10e45fd760d7/Kaguya-sama.jpg?v=1749799578073", title: "Kaguya-sama:Love is War", description: "Deux g√©nies amoureux se livrent une guerre psychologique pour ne pas avouer en premier." },
          { image: "https://cdn.glitch.global/92297865-8423-4fe1-928c-10e45fd760d7/Kaguya-sama.jpg?v=1749799578073", title: "Kaguya-sama:Love is War", description: "Deux g√©nies amoureux se livrent une guerre psychologique pour ne pas avouer en premier." },
          { image: "https://cdn.glitch.global/92297865-8423-4fe1-928c-10e45fd760d7/Kaguya-sama.jpg?v=1749799578073", title: "Kaguya-sama:Love is War", description: "Deux g√©nies amoureux se livrent une guerre psychologique pour ne pas avouer en premier." },
          { image: "https://cdn.glitch.global/92297865-8423-4fe1-928c-10e45fd760d7/Kaguya-sama.jpg?v=1749799578073", title: "Kaguya-sama:Love is War", description: "Deux g√©nies amoureux se livrent une guerre psychologique pour ne pas avouer en premier." },
          { image: "https://cdn.glitch.global/92297865-8423-4fe1-928c-10e45fd760d7/Kaguya-sama.jpg?v=1749799578073", title: "Kaguya-sama:Love is War", description: "Deux g√©nies amoureux se livrent une guerre psychologique pour ne pas avouer en premier." },
      ],
      "Ambition": [
          { image: "https://cdn.glitch.global/92297865-8423-4fe1-928c-10e45fd760d7/Death%20Note.jpg?v=1749799016263", title: "Death Note", description: "Un lyc√©en d√©couvre un carnet qui tue les gens dont il √©crit le nom √† l'int√©rieur." },
          { image: "https://cdn.glitch.global/92297865-8423-4fe1-928c-10e45fd760d7/Death%20Note.jpg?v=1749799016263", title: "Death Note", description: "Un lyc√©en d√©couvre un carnet qui tue les gens dont il √©crit le nom √† l'int√©rieur." },
          { image: "https://cdn.glitch.global/92297865-8423-4fe1-928c-10e45fd760d7/Death%20Note.jpg?v=1749799016263", title: "Death Note", description: "Un lyc√©en d√©couvre un carnet qui tue les gens dont il √©crit le nom √† l'int√©rieur." },
          { image: "https://cdn.glitch.global/92297865-8423-4fe1-928c-10e45fd760d7/Death%20Note.jpg?v=1749799016263", title: "Death Note", description: "Un lyc√©en d√©couvre un carnet qui tue les gens dont il √©crit le nom √† l'int√©rieur." },
          { image: "https://cdn.glitch.global/92297865-8423-4fe1-928c-10e45fd760d7/Death%20Note.jpg?v=1749799016263", title: "Death Note", description: "Un lyc√©en d√©couvre un carnet qui tue les gens dont il √©crit le nom √† l'int√©rieur." },
          { image: "https://cdn.glitch.global/92297865-8423-4fe1-928c-10e45fd760d7/Death%20Note.jpg?v=1749799016263", title: "Death Note", description: "Un lyc√©en d√©couvre un carnet qui tue les gens dont il √©crit le nom √† l'int√©rieur." },
          { image: "https://cdn.glitch.global/92297865-8423-4fe1-928c-10e45fd760d7/Death%20Note.jpg?v=1749799016263", title: "Death Note", description: "Un lyc√©en d√©couvre un carnet qui tue les gens dont il √©crit le nom √† l'int√©rieur." },
          { image: "https://cdn.glitch.global/92297865-8423-4fe1-928c-10e45fd760d7/Death%20Note.jpg?v=1749799016263", title: "Death Note", description: "Un lyc√©en d√©couvre un carnet qui tue les gens dont il √©crit le nom √† l'int√©rieur." },
      ],
      "Mati√®res pr√©f√©r√©es": [
        { image: "https://cdn.glitch.global/753b2206-8aec-499d-95ff-df1dc687ac0e/Solo%20Leveling.jpg?v=1749755167270", title: "Solo Leveling", description: "Apr√®s avoir √©t√© le plus faible des chasseurs, Sung Jin-woo d√©couvre un myst√©rieux ¬´ journal de qu√™te ¬ª qui lui permet de monter de niveau ind√©pendamment des autres. Devenu le chasseur le plus puissant, il affronte des donjons et des √™tres surnaturels pour prot√©ger l‚Äôhumanit√©." },
          { image: "https://cdn.glitch.global/753b2206-8aec-499d-95ff-df1dc687ac0e/Solo%20Leveling.jpg?v=1749755167270", title: "Solo Leveling", description: "Apr√®s avoir √©t√© le plus faible des chasseurs, Sung Jin-woo d√©couvre un myst√©rieux ¬´ journal de qu√™te ¬ª qui lui permet de monter de niveau ind√©pendamment des autres. Devenu le chasseur le plus puissant, il affronte des donjons et des √™tres surnaturels pour prot√©ger l‚Äôhumanit√©." },
          { image: "https://cdn.glitch.global/753b2206-8aec-499d-95ff-df1dc687ac0e/Solo%20Leveling.jpg?v=1749755167270", title: "Solo Leveling", description: "Apr√®s avoir √©t√© le plus faible des chasseurs, Sung Jin-woo d√©couvre un myst√©rieux ¬´ journal de qu√™te ¬ª qui lui permet de monter de niveau ind√©pendamment des autres. Devenu le chasseur le plus puissant, il affronte des donjons et des √™tres surnaturels pour prot√©ger l‚Äôhumanit√©." },
          { image: "https://cdn.glitch.global/753b2206-8aec-499d-95ff-df1dc687ac0e/Solo%20Leveling.jpg?v=1749755167270", title: "Solo Leveling", description: "Apr√®s avoir √©t√© le plus faible des chasseurs, Sung Jin-woo d√©couvre un myst√©rieux ¬´ journal de qu√™te ¬ª qui lui permet de monter de niveau ind√©pendamment des autres. Devenu le chasseur le plus puissant, il affronte des donjons et des √™tres surnaturels pour prot√©ger l‚Äôhumanit√©." },
          { image: "https://cdn.glitch.global/753b2206-8aec-499d-95ff-df1dc687ac0e/Solo%20Leveling.jpg?v=1749755167270", title: "Solo Leveling", description: "Apr√®s avoir √©t√© le plus faible des chasseurs, Sung Jin-woo d√©couvre un myst√©rieux ¬´ journal de qu√™te ¬ª qui lui permet de monter de niveau ind√©pendamment des autres. Devenu le chasseur le plus puissant, il affronte des donjons et des √™tres surnaturels pour prot√©ger l‚Äôhumanit√©." },
          { image: "https://cdn.glitch.global/753b2206-8aec-499d-95ff-df1dc687ac0e/Solo%20Leveling.jpg?v=1749755167270", title: "Solo Leveling", description: "Apr√®s avoir √©t√© le plus faible des chasseurs, Sung Jin-woo d√©couvre un myst√©rieux ¬´ journal de qu√™te ¬ª qui lui permet de monter de niveau ind√©pendamment des autres. Devenu le chasseur le plus puissant, il affronte des donjons et des √™tres surnaturels pour prot√©ger l‚Äôhumanit√©." },
          { image: "https://cdn.glitch.global/753b2206-8aec-499d-95ff-df1dc687ac0e/Solo%20Leveling.jpg?v=1749755167270", title: "Solo Leveling", description: "Apr√®s avoir √©t√© le plus faible des chasseurs, Sung Jin-woo d√©couvre un myst√©rieux ¬´ journal de qu√™te ¬ª qui lui permet de monter de niveau ind√©pendamment des autres. Devenu le chasseur le plus puissant, il affronte des donjons et des √™tres surnaturels pour prot√©ger l‚Äôhumanit√©." },
          { image: "https://cdn.glitch.global/753b2206-8aec-499d-95ff-df1dc687ac0e/Solo%20Leveling.jpg?v=1749755167270", title: "Solo Leveling", description: "Apr√®s avoir √©t√© le plus faible des chasseurs, Sung Jin-woo d√©couvre un myst√©rieux ¬´ journal de qu√™te ¬ª qui lui permet de monter de niveau ind√©pendamment des autres. Devenu le chasseur le plus puissant, il affronte des donjons et des √™tres surnaturels pour prot√©ger l‚Äôhumanit√©." },
          { image: "https://cdn.glitch.global/753b2206-8aec-499d-95ff-df1dc687ac0e/Solo%20Leveling.jpg?v=1749755167270", title: "Solo Leveling", description: "Apr√®s avoir √©t√© le plus faible des chasseurs, Sung Jin-woo d√©couvre un myst√©rieux ¬´ journal de qu√™te ¬ª qui lui permet de monter de niveau ind√©pendamment des autres. Devenu le chasseur le plus puissant, il affronte des donjons et des √™tres surnaturels pour prot√©ger l‚Äôhumanit√©." },
      ]};
      // set up du tournoi
             let selectedCategory = "All-Time";
  let currentRound = [];
  let winners = [];
  let pairIndex = 0;
  let roundNumber = 1;
  let totalRounds = 0;

  const card1 = document.getElementById('card1');
  const card2 = document.getElementById('card2');
  const roundIndicator = document.getElementById('roundIndicator');
  const categoryElements = document.querySelectorAll('.category');
  const cardContainer = document.querySelector('.card-container');

  function normalizeCategory(cat) {
    return cat.trim().toLowerCase();
  }

  function shuffleArray(array) {
    for (let i = array.length - 1; i > 0; i--) {
      const j = Math.floor(Math.random() * (i + 1));
      [array[i], array[j]] = [array[j], array[i]];
    }
  }

  function updateRoundIndicator() {
    roundIndicator.textContent = `Round ${roundNumber} sur ${totalRounds} (${currentRound.length} participants)`;
  }

  async function loadPair() {
  console.log("loadPair appel√©, winners.length :", winners.length, "winners :", winners);
  if (pairIndex < currentRound.length - 1) {
    const leftManga = currentRound[pairIndex];
    const rightManga = currentRound[pairIndex + 1];
    card1.innerHTML = `
      <img src="${leftManga.image}" alt="${leftManga.title}">
      <div class="info">
        <h2>${leftManga.title}</h2>
        <p>${leftManga.description}</p>
      </div>
    `;
    card2.innerHTML = `
      <img src="${rightManga.image}" alt="${rightManga.title}">
      <div class="info">
        <h2>${rightManga.title}</h2>
        <p>${rightManga.description}</p>
      </div>
    `;
  } else {
    if (winners.length === 1) {
      console.log("Fin du tournoi atteinte, gagnant :", winners[0], "title :", winners[0].title);
    
  document.body.classList.add('victory-background');
  document.body.innerHTML = `
    <button class="btn-finish">‚Üê Retour imm√©diat</button>
    <div class="winner">
      <h1>üèÜ Manga Gagnant üèÜ</h1>
      <h2>${winners[0].title}</h2>
      <img src="${winners[0].image}" alt="${winners[0].title}" class="winner-img">
      <p>${winners[0].description}</p>
      <p class="compte-rebours">Retour √† l'accueil dans <span id="countdown">10</span> secondes...</p>
      <button id="btn-stats" class="gradient-button">üìä Acc√©der aux Statistiques</button>
    </div>
  `;

  document.getElementById('btn-stats').addEventListener('click', () => {
    window.location.href = 'statistiques.html';
  });

  let seconds = 10;
  const countdownEl = document.getElementById("countdown");
  const timer = setInterval(() => {
    seconds--;
    countdownEl.textContent = seconds;
    if (seconds <= 0) {
      clearInterval(timer);
      window.location.href = "Manga.html";
    }
  }, 1000);

  document.querySelector('.btn-finish').addEventListener('click', () => {
    clearInterval(timer);
    window.location.href = "Manga.html";
  });

      } else {
        currentRound = winners;
        winners = [];
        pairIndex = 0;
        roundNumber++;
        shuffleArray(currentRound);
        updateRoundIndicator();
        loadPair();
      }
    }
  }

  function chooseWinner(index) {
    winners.push(currentRound[pairIndex + index]);
    pairIndex += 2;
    loadPair();
  }

  function initializeTournament() {
    const keys = Object.keys(categoriesData);
    const foundKey = keys.find(k => normalizeCategory(k) === normalizeCategory(selectedCategory));

    if (foundKey && categoriesData[foundKey].length > 0) {
      currentRound = [...categoriesData[foundKey]];
      totalRounds = Math.log2(currentRound.length);
      if (!Number.isInteger(totalRounds)) {
        const validLength = Math.pow(2, Math.floor(totalRounds));
        currentRound = currentRound.slice(0, validLength);
        totalRounds = Math.floor(totalRounds);
      }
      shuffleArray(currentRound);
      winners = [];
      pairIndex = 0;
      roundNumber = 1;
      updateRoundIndicator();
      loadPair();
    } else {
      cardContainer.innerHTML = `<div class="winner"><h2>Aucun choix pour cette cat√©gorie.</h2></div>`;
      roundIndicator.textContent = '';
    }
  }

  categoryElements.forEach(elem => {
    elem.addEventListener('click', () => {
      categoryElements.forEach(e => e.classList.remove('selected'));
      elem.classList.add('selected');
      selectedCategory = elem.getAttribute('data-category');
      initializeTournament();
    });
  });

  const urlParams = new URLSearchParams(window.location.search);
  const categoryParam = urlParams.get('category');
  if (categoryParam) {
    selectedCategory = categoryParam;
    categoryElements.forEach(e => e.classList.remove('selected'));
    const targetCat = Array.from(categoryElements).find(c => normalizeCategory(c.dataset.category) === normalizeCategory(categoryParam));
    if (targetCat) targetCat.classList.add('selected');
  }

  card1.addEventListener('click', () => chooseWinner(0));
  card2.addEventListener('click', () => chooseWinner(1));

  initializeTournament();
});
    </script>
  
  </body>
  </html>
