<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="icon" type="images/logo-sd.png" href="logo-sd.png">
    <link rel="stylesheet" href="css/choix.css">
    <title>Test de personalité</title>
</head>
<body>

  <header>
    <h1>Test pour mieux vous connaître.</h1>
    <div class="categories">
      <div class="category selected" data-category="All-Time">Matières préférées</div>
      <div class="category" data-category="Shōnen">Compétences</div>
      <div class="category" data-category="Shōjo">Vie étudiante</div>
      <div class="category" data-category="Seinen">Ambition</div>
      <div class="category" data-category="Manhwa">Profil étudiant</div>
    </div>
    <div id="roundIndicator">Round 1</div>
  </header>

  <div class="card-container">
    <div class="card" id="card1"></div>
    <div class="card" id="card2"></div>    
  </div>

  <script>
    // Données pour les différentes catégories
    document.addEventListener('DOMContentLoaded', () => {

    const categoriesData = {
      "Matière étudiées": [
        { image: "https://unsplash.com/fr/photos/une-personne-ecrit-sur-un-morceau-de-papier-ykgLX_CwtDw", title: "Statistiques", description: "Étude des données numériques pour identifier des tendances et faire des prédictions." },
        { image: "https://unsplash.com/fr/photos/lignes-de-codes-html-4hbJ-eymZ1o", title: "Programmation", description: "Apprentissage des langages informatiques pour créer des logiciels et automatiser des tâches." },
        { image: "https://unsplash.com/fr/photos/personne-ecrivant-sur-du-papier-blanc-qDgTQOYk6B8", title: "Proba", description: "Compréhension des événements aléatoires et calcul des chances dans différentes situations." },
        { image: "https://unsplash.com/fr/photos/icone-kSbnzTXX7fw", title: "Cryptologie", description: "Étude des données numériques pour identifier des tendances et faire des prédictions." },
        { image: "https://unsplash.com/fr/photos/fond-abstrait-de-numero-de-code-numerique-representent-la-technologie-de-codage-et-les-langages-de-programmation-00IATt47-Lc", title: "Algorithmes", description: "Développement de méthodes et procédures logiques pour résoudre des problèmes informatiques." },
        { image: "https://www.pexels.com/fr-fr/photo/lumineux-leger-marketing-businessman-5716032/", title: "Prog statistiques", description: "Utilisation de langages pour analyser et modéliser des données complexes." },
        { image: "https://unsplash.com/fr/photos/un-logo-bleu-et-blanc-ahgsuFHlIFo", title: "Base de données", description: "Conception et manipulation de systèmes pour stocker et récupérer des données efficacement." },
        { image: "https://unsplash.com/fr/photos/personne-utilisant-macbook-pro-sur-une-table-blanche-AvSFPw5Tp68", title: "Cybersécurité", description: "Protection des systèmes et des données contre les attaques et les intrusions." },

      ],
      "Compétences": [
        { image: "https://unsplash.com/fr/photos/ecran-plat-noir-ecran-dordinateur-oXlXu2qukGE", title: "Développer un site Web", description: "Créer et maintenir des sites internet accessibles et fonctionnels." },
        { image: "https://unsplash.com/fr/photos/personne-tenant-un-iphone-5-c-blanc-bMTl6uFMONg", title: "Créer une application mobile", description: "Développer des apps pour smartphones et tablettes." },
        { image: "https://unsplash.com/fr/photos/graphiques-danalyse-des-performances-sur-un-ecran-dordinateur-portable-JKUTrJ4vK00", title: "Créer un Dashboard de données", description: "Construire des tableaux de bord pour visualiser et interpréter les informations." },
        { image: "https://unsplash.com/fr/photos/personne-tenant-bleu-sony-ps4-dualshock-4-c-TYoA7O_OmPc", title: "Créer un jeu vidéos", description: "Concevoir et programmer des jeux interactifs pour différents supports." },
        { image: "https://unsplash.com/fr/photos/un-groupe-de-carres-bleus-pr5lUMgocTs", title: "Manipuler des bases de données", description: "Rechercher, organiser et gérer des informations de manière efficace." },
        { image: "https://unsplash.com/fr/photos/personne-en-chemise-bleue-ecrivant-sur-papier-blanc-8mikJ83LmSQ", title: "Analyser des graphiques", description: "Représenter des données sous forme graphique pour mieux les comprendre." },
        { image: "https://unsplash.com/fr/photos/debogage-de-code-vy7GOqb1M9s", title: "Déboguer un code", description: "Identifier et corriger les erreurs dans des programmes informatiques." },
        { image: "https://unsplash.com/fr/photos/voitures-garees-dans-une-rue-de-la-ville-la-nuit-MSG9xrzSSew", title: "Faire une enquête", description: "Collecter et analyser des informations pour en tirer des conclusions pertinentes." },   
      ],
      "Vie étudiante": [
          { image: "https://unsplash.com/fr/photos/groupe-de-personnes-devant-la-scene-ZhQCZjr9fHo", title: "Participer aux soirées", description: "S’investir dans la vie sociale et profiter des événements étudiants." },
          { image: "https://unsplash.com/fr/photos/personnes-assises-sur-un-banc-pres-dun-batiment-pendant-la-nuit-yShgFDXrqFk", title: "Rester chez soi", description: "Préférer les activités tranquilles et personnelles à la maison." },
          { image: "https://unsplash.com/fr/photos/femme-en-debardeur-noir-assise-sur-un-banc-en-bois-marron-0Wra5YYVQJE", title: "Faire du sport", description: "Pratiquer régulièrement une activité physique pour rester en forme." },
          { image: "https://unsplash.com/fr/photos/photographie-de-mise-au-point-selective-de-la-console-ps4-sony-blanche-avec-manette-sans-fil-mwytIca3qNA", title: "Jouer aux jeux vidéo", description: "Se divertir et développer des compétences stratégiques ou collaboratives." },
          { image: "https://unsplash.com/fr/photos/jeune-travailleur-conduisant-un-transpalette-tout-en-travaillant-dans-un-entrepot-industriel-jjI9yNPXeUE", title: "Travailler le week-end", description: "Consacrer du temps supplémentaire aux études ou projets." },
          { image: "https://unsplash.com/fr/photos/une-personne-assise-sur-un-lit-tenant-une-tasse-de-cafe-UWkFctAooic", title: "Se reposer tranquillement", description: "Prendre du temps pour soi pour récupérer et se détendre." },
          { image: "https://unsplash.com/fr/photos/homme-en-t-shirt-rouge-tenant-une-bouteille-en-plastique-blanche-Cns0h4ypRyA", title: "S’investir dans une association", description: "Participer activement à des projets collectifs ou humanitaires." },
          { image: "https://unsplash.com/fr/photos/un-homme-assis-a-une-table-avec-des-papiers-et-une-calculatrice-vKp3IJjO21o", title: "Faire des projets personnels", description: "Développer ses propres idées ou loisirs en dehors des cours." },
      ],
      "Ambition": [
          { image: "https://unsplash.com/fr/photos/un-homme-et-une-femme-se-serrant-la-main-devant-un-ordinateur-portable-qFSQFSmfZkA", title: "Trouver un emploi rapidement", description: "Intégrer le marché du travail dès la fin de la formation." },
          { image: "https://unsplash.com/fr/photos/une-petite-figurine-posee-sur-un-livre-ouvert-7dvjXF_lqxw", title: "Continuer les études", description: "Poursuivre avec un master ou une école spécialisée pour approfondir ses connaissances." },
          { image: "https://unsplash.com/fr/photos/femme-en-pull-marron-a-laide-dun-ordinateur-portable-kRWY72TKB0Y", title: "Travailler dans une grande entreprise", description: "Rejoindre une structure organisée avec des missions variées et sécurisées." },
          { image: "https://unsplash.com/fr/photos/une-couturiere-travaille-sur-une-machine-a-coudre-9-K82X6tOfw", title: "Créer sa propre entreprise", description: "Monter un projet entrepreneurial et gérer son activité de manière indépendante." },
          { image: "https://unsplash.com/fr/photos/un-groupe-de-personnes-en-robes-de-graduation-debout-sur-une-scene-mZlLNZhnvcs", title: "Faire un BUT/Master/École d’ingénieur", description: "Se spécialiser et obtenir un diplôme supérieur." },
          { image: "https://unsplash.com/fr/photos/illustration-de-bus-jaune-et-rouge-lSZ5epC5B5k", title: "Arrêter l’école", description: "Choisir d’entrer directement dans la vie active ou un autre projet personnel." },
          { image: "https://unsplash.com/fr/photos/une-personne-pointant-une-carte-avec-des-epingles-dessus-SFRw5GChoLA", title: "Partir à l’étranger", description: "Travailler ou étudier dans un autre pays pour vivre une expérience internationale." },
          { image: "https://unsplash.com/fr/photos/la-tour-eiffel-dominant-la-ville-de-paris--om-7MGkIR0", title: "Rester travailler localement", description: "Se concentrer sur des opportunités professionnelles proches de chez soi." },
      ],
      "": [
          { image: "https://cdn.glitch.global/753b2206-8aec-499d-95ff-df1dc687ac0e/Solo%20Leveling.jpg?v=1749755167270", title: "Solo Leveling", description: "Après avoir été le plus faible des chasseurs, Sung Jin-woo découvre un mystérieux « journal de quête » qui lui permet de monter de niveau indépendamment des autres. Devenu le chasseur le plus puissant, il affronte des donjons et des êtres surnaturels pour protéger l’humanité." },
          { image: "https://cdn.glitch.global/753b2206-8aec-499d-95ff-df1dc687ac0e/Solo%20Leveling.jpg?v=1749755167270", title: "Solo Leveling", description: "Après avoir été le plus faible des chasseurs, Sung Jin-woo découvre un mystérieux « journal de quête » qui lui permet de monter de niveau indépendamment des autres. Devenu le chasseur le plus puissant, il affronte des donjons et des êtres surnaturels pour protéger l’humanité." },
          { image: "https://cdn.glitch.global/753b2206-8aec-499d-95ff-df1dc687ac0e/Solo%20Leveling.jpg?v=1749755167270", title: "Solo Leveling", description: "Après avoir été le plus faible des chasseurs, Sung Jin-woo découvre un mystérieux « journal de quête » qui lui permet de monter de niveau indépendamment des autres. Devenu le chasseur le plus puissant, il affronte des donjons et des êtres surnaturels pour protéger l’humanité." },
          { image: "https://cdn.glitch.global/753b2206-8aec-499d-95ff-df1dc687ac0e/Solo%20Leveling.jpg?v=1749755167270", title: "Solo Leveling", description: "Après avoir été le plus faible des chasseurs, Sung Jin-woo découvre un mystérieux « journal de quête » qui lui permet de monter de niveau indépendamment des autres. Devenu le chasseur le plus puissant, il affronte des donjons et des êtres surnaturels pour protéger l’humanité." },
          { image: "https://cdn.glitch.global/753b2206-8aec-499d-95ff-df1dc687ac0e/Solo%20Leveling.jpg?v=1749755167270", title: "Solo Leveling", description: "Après avoir été le plus faible des chasseurs, Sung Jin-woo découvre un mystérieux « journal de quête » qui lui permet de monter de niveau indépendamment des autres. Devenu le chasseur le plus puissant, il affronte des donjons et des êtres surnaturels pour protéger l’humanité." },
          { image: "https://cdn.glitch.global/753b2206-8aec-499d-95ff-df1dc687ac0e/Solo%20Leveling.jpg?v=1749755167270", title: "Solo Leveling", description: "Après avoir été le plus faible des chasseurs, Sung Jin-woo découvre un mystérieux « journal de quête » qui lui permet de monter de niveau indépendamment des autres. Devenu le chasseur le plus puissant, il affronte des donjons et des êtres surnaturels pour protéger l’humanité." },
          { image: "https://cdn.glitch.global/753b2206-8aec-499d-95ff-df1dc687ac0e/Solo%20Leveling.jpg?v=1749755167270", title: "Solo Leveling", description: "Après avoir été le plus faible des chasseurs, Sung Jin-woo découvre un mystérieux « journal de quête » qui lui permet de monter de niveau indépendamment des autres. Devenu le chasseur le plus puissant, il affronte des donjons et des êtres surnaturels pour protéger l’humanité." },
          { image: "https://cdn.glitch.global/753b2206-8aec-499d-95ff-df1dc687ac0e/Solo%20Leveling.jpg?v=1749755167270", title: "Solo Leveling", description: "Après avoir été le plus faible des chasseurs, Sung Jin-woo découvre un mystérieux « journal de quête » qui lui permet de monter de niveau indépendamment des autres. Devenu le chasseur le plus puissant, il affronte des donjons et des êtres surnaturels pour protéger l’humanité." },
          { image: "https://cdn.glitch.global/753b2206-8aec-499d-95ff-df1dc687ac0e/Solo%20Leveling.jpg?v=1749755167270", title: "Solo Leveling", description: "Après avoir été le plus faible des chasseurs, Sung Jin-woo découvre un mystérieux « journal de quête » qui lui permet de monter de niveau indépendamment des autres. Devenu le chasseur le plus puissant, il affronte des donjons et des êtres surnaturels pour protéger l’humanité." },
      ]};
      // set up du tournoi
  let selectedCategory = "Matières étudiées";
  let currentRound = [];
  let winners = [];
  let pairIndex = 0;
  let roundNumber = 1;
  let totalRounds = 0;

  const card1 = document.getElementById('card1');
  const card2 = document.getElementById('card2');
  const roundIndicator = document.getElementById('roundIndicator');
  const categoryElements = document.querySelectorAll('.category');
  const cardContainer = document.querySelector('.card-container');

  function normalizeCategory(cat) {
    return cat.trim().toLowerCase();
  }

  function shuffleArray(array) {
    for (let i = array.length - 1; i > 0; i--) {
      const j = Math.floor(Math.random() * (i + 1));
      [array[i], array[j]] = [array[j], array[i]];
    }
  }

  function updateRoundIndicator() {
    roundIndicator.textContent = `Round ${roundNumber} sur ${totalRounds} (${currentRound.length} participants)`;
  }

  async function loadPair() {
  console.log("loadPair appelé, winners.length :", winners.length, "winners :", winners);
  if (pairIndex < currentRound.length - 1) {
    const leftManga = currentRound[pairIndex];
    const rightManga = currentRound[pairIndex + 1];
    card1.innerHTML = `
      <img src="${leftManga.image}" alt="${leftManga.title}">
      <div class="info">
        <h2>${leftManga.title}</h2>
        <p>${leftManga.description}</p>
      </div>
    `;
    card2.innerHTML = `
      <img src="${rightManga.image}" alt="${rightManga.title}">
      <div class="info">
        <h2>${rightManga.title}</h2>
        <p>${rightManga.description}</p>
      </div>
    `;
  } else {
    if (winners.length === 1) {
      console.log("Fin du tournoi atteinte, gagnant :", winners[0], "title :", winners[0].title);
    
  document.body.classList.add('victory-background');
  document.body.innerHTML = `
    <button class="btn-finish">← Retour immédiat</button>
    <div class="winner">
      <h1>🏆 Manga Gagnant 🏆</h1>
      <h2>${winners[0].title}</h2>
      <img src="${winners[0].image}" alt="${winners[0].title}" class="winner-img">
      <p>${winners[0].description}</p>
      <p class="compte-rebours">Retour à l'accueil dans <span id="countdown">10</span> secondes...</p>
      <button id="btn-stats" class="gradient-button">📊 Accéder aux Statistiques</button>
    </div>
  `;

  document.getElementById('btn-stats').addEventListener('click', () => {
    window.location.href = 'statistiques.html';
  });

  let seconds = 10;
  const countdownEl = document.getElementById("countdown");
  const timer = setInterval(() => {
    seconds--;
    countdownEl.textContent = seconds;
    if (seconds <= 0) {
      clearInterval(timer);
      window.location.href = "Manga.html";
    }
  }, 1000);

  document.querySelector('.btn-finish').addEventListener('click', () => {
    clearInterval(timer);
    window.location.href = "Manga.html";
  });

      } else {
        currentRound = winners;
        winners = [];
        pairIndex = 0;
        roundNumber++;
        shuffleArray(currentRound);
        updateRoundIndicator();
        loadPair();
      }
    }
  }

  function chooseWinner(index) {
    winners.push(currentRound[pairIndex + index]);
    pairIndex += 2;
    loadPair();
  }

  function initializeTournament() {
    const keys = Object.keys(categoriesData);
    const foundKey = keys.find(k => normalizeCategory(k) === normalizeCategory(selectedCategory));

    if (foundKey && categoriesData[foundKey].length > 0) {
      currentRound = [...categoriesData[foundKey]];
      totalRounds = Math.log2(currentRound.length);
      if (!Number.isInteger(totalRounds)) {
        const validLength = Math.pow(2, Math.floor(totalRounds));
        currentRound = currentRound.slice(0, validLength);
        totalRounds = Math.floor(totalRounds);
      }
      shuffleArray(currentRound);
      winners = [];
      pairIndex = 0;
      roundNumber = 1;
      updateRoundIndicator();
      loadPair();
    } else {
      cardContainer.innerHTML = `<div class="winner"><h2>Aucun choix pour cette catégorie.</h2></div>`;
      roundIndicator.textContent = '';
    }
  }

  categoryElements.forEach(elem => {
    elem.addEventListener('click', () => {
      categoryElements.forEach(e => e.classList.remove('selected'));
      elem.classList.add('selected');
      selectedCategory = elem.getAttribute('data-category');
      initializeTournament();
    });
  });

  const urlParams = new URLSearchParams(window.location.search);
  const categoryParam = urlParams.get('category');
  if (categoryParam) {
    selectedCategory = categoryParam;
    categoryElements.forEach(e => e.classList.remove('selected'));
    const targetCat = Array.from(categoryElements).find(c => normalizeCategory(c.dataset.category) === normalizeCategory(categoryParam));
    if (targetCat) targetCat.classList.add('selected');
  }

  card1.addEventListener('click', () => chooseWinner(0));
  card2.addEventListener('click', () => chooseWinner(1));

  initializeTournament();
});
    </script> 
  </body>
  </html>
