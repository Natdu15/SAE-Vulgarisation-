<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="icon" type="logo-sd.png" href="logo-sd.png">
    <link rel="stylesheet" href="css/choix.css">
    <title>Test de personalité</title>
</head>
<body>

  <header>
    <h1>Test pour mieux vous connaître.</h1>
    <div class="categories">
      <div class="category selected" data-category="All-Time">Profil étudiant</div>
      <div class="category" data-category="Shōnen">Compétences</div>
      <div class="category" data-category="Shōjo">Vie étudiante</div>
      <div class="category" data-category="Seinen">Ambition</div>
      <div class="category" data-category="Manhwa">Matières préférées</div>
    </div>
    <div id="roundIndicator">Round 1</div>
  </header>

  <div class="card-container">
    <div class="card" id="card1"></div>
    <div class="card" id="card2"></div>
  </div>

  <script>
    // Données pour les différentes catégories
    document.addEventListener('DOMContentLoaded', () => {

    const categoriesData = {
      "Matière étudiés": [
        { image: "https://unsplash.com/fr/photos/une-personne-ecrit-sur-un-morceau-de-papier-ykgLX_CwtDw", title: "Statistiques", description: "Étude des données numériques pour identifier des tendances et faire des prédictions." },
        { image: "https://unsplash.com/fr/photos/lignes-de-codes-html-4hbJ-eymZ1o", title: "Programmation", description: "Apprentissage des langages informatiques pour créer des logiciels et automatiser des tâches." },
        { image: "https://unsplash.com/fr/photos/une-personne-ecrit-sur-un-morceau-de-papier-ykgLX_CwtDw", title: "Proba", description: "Compréhension des événements aléatoires et calcul des chances dans différentes situations." },
        { image: "https://unsplash.com/fr/photos/une-personne-ecrit-sur-un-morceau-de-papier-ykgLX_CwtDw", title: "Cryptologie", description: "Étude des données numériques pour identifier des tendances et faire des prédictions." },
        { image: "https://unsplash.com/fr/photos/une-personne-ecrit-sur-un-morceau-de-papier-ykgLX_CwtDw", title: "Algorithmes", description: "Développement de méthodes et procédures logiques pour résoudre des problèmes informatiques." },
        { image: "https://unsplash.com/fr/photos/une-personne-ecrit-sur-un-morceau-de-papier-ykgLX_CwtDw", title: "Prog statistiques", description: "Utilisation de langages pour analyser et modéliser des données complexes." },
        { image: "https://unsplash.com/fr/photos/une-personne-ecrit-sur-un-morceau-de-papier-ykgLX_CwtDw", title: "Base de données", description: "Conception et manipulation de systèmes pour stocker et récupérer des données efficacement." },
        { image: "https://unsplash.com/fr/photos/une-personne-ecrit-sur-un-morceau-de-papier-ykgLX_CwtDw", title: "Cybersécurité", description: "Protection des systèmes et des données contre les attaques et les intrusions." },

      ],
      "Compétences": [
        { image: "https://unsplash.com/fr/photos/une-personne-ecrit-sur-un-morceau-de-papier-ykgLX_CwtDw", title: "Développer un site Web", description: "Créer et maintenir des sites internet accessibles et fonctionnels." },
        { image: "https://unsplash.com/fr/photos/une-personne-ecrit-sur-un-morceau-de-papier-ykgLX_CwtDw", title: "Créer une application mobile", description: "Développer des apps pour smartphones et tablettes." },
        { image: "https://unsplash.com/fr/photos/une-personne-ecrit-sur-un-morceau-de-papier-ykgLX_CwtDw", title: "Créer un Dashboard de données", description: "Construire des tableaux de bord pour visualiser et interpréter les informations." },
        { image: "https://unsplash.com/fr/photos/une-personne-ecrit-sur-un-morceau-de-papier-ykgLX_CwtDw", title: "Créer un jeu vidéos", description: "Concevoir et programmer des jeux interactifs pour différents supports." },
        { image: "https://unsplash.com/fr/photos/une-personne-ecrit-sur-un-morceau-de-papier-ykgLX_CwtDw", title: "Manipuler des bases de données", description: "Rechercher, organiser et gérer des informations de manière efficace." },
        { image: "https://unsplash.com/fr/photos/une-personne-ecrit-sur-un-morceau-de-papier-ykgLX_CwtDw", title: "Analyser des graphiques", description: "Représenter des données sous forme graphique pour mieux les comprendre." },
        { image: "https://unsplash.com/fr/photos/une-personne-ecrit-sur-un-morceau-de-papier-ykgLX_CwtDw", title: "Déboguer un code", description: "Identifier et corriger les erreurs dans des programmes informatiques." },
        { image: "https://cdn.glitch.global/92297865-8423-4fe1-928c-10e45fd760d7/Dragon%20Ball%20Z.jpg?v=1749799157209", title: "Faire une enquête", description: "Collecter et analyser des informations pour en tirer des conclusions pertinentes." },   
      ],
      "Vie étudiante": [
        { image: "https://cdn.glitch.global/92297865-8423-4fe1-928c-10e45fd760d7/Kaguya-sama.jpg?v=1749799578073", title: "Kaguya-sama:Love is War", description: "Deux génies amoureux se livrent une guerre psychologique pour ne pas avouer en premier." },
          { image: "https://cdn.glitch.global/92297865-8423-4fe1-928c-10e45fd760d7/Kaguya-sama.jpg?v=1749799578073", title: "Kaguya-sama:Love is War", description: "Deux génies amoureux se livrent une guerre psychologique pour ne pas avouer en premier." },
          { image: "https://cdn.glitch.global/92297865-8423-4fe1-928c-10e45fd760d7/Kaguya-sama.jpg?v=1749799578073", title: "Kaguya-sama:Love is War", description: "Deux génies amoureux se livrent une guerre psychologique pour ne pas avouer en premier." },
          { image: "https://cdn.glitch.global/92297865-8423-4fe1-928c-10e45fd760d7/Kaguya-sama.jpg?v=1749799578073", title: "Kaguya-sama:Love is War", description: "Deux génies amoureux se livrent une guerre psychologique pour ne pas avouer en premier." },
          { image: "https://cdn.glitch.global/92297865-8423-4fe1-928c-10e45fd760d7/Kaguya-sama.jpg?v=1749799578073", title: "Kaguya-sama:Love is War", description: "Deux génies amoureux se livrent une guerre psychologique pour ne pas avouer en premier." },
          { image: "https://cdn.glitch.global/92297865-8423-4fe1-928c-10e45fd760d7/Kaguya-sama.jpg?v=1749799578073", title: "Kaguya-sama:Love is War", description: "Deux génies amoureux se livrent une guerre psychologique pour ne pas avouer en premier." },
          { image: "https://cdn.glitch.global/92297865-8423-4fe1-928c-10e45fd760d7/Kaguya-sama.jpg?v=1749799578073", title: "Kaguya-sama:Love is War", description: "Deux génies amoureux se livrent une guerre psychologique pour ne pas avouer en premier." },
          { image: "https://cdn.glitch.global/92297865-8423-4fe1-928c-10e45fd760d7/Kaguya-sama.jpg?v=1749799578073", title: "Kaguya-sama:Love is War", description: "Deux génies amoureux se livrent une guerre psychologique pour ne pas avouer en premier." },
      ],
      "Ambition": [
          { image: "https://cdn.glitch.global/92297865-8423-4fe1-928c-10e45fd760d7/Death%20Note.jpg?v=1749799016263", title: "Death Note", description: "Un lycéen découvre un carnet qui tue les gens dont il écrit le nom à l'intérieur." },
          { image: "https://cdn.glitch.global/92297865-8423-4fe1-928c-10e45fd760d7/Death%20Note.jpg?v=1749799016263", title: "Death Note", description: "Un lycéen découvre un carnet qui tue les gens dont il écrit le nom à l'intérieur." },
          { image: "https://cdn.glitch.global/92297865-8423-4fe1-928c-10e45fd760d7/Death%20Note.jpg?v=1749799016263", title: "Death Note", description: "Un lycéen découvre un carnet qui tue les gens dont il écrit le nom à l'intérieur." },
          { image: "https://cdn.glitch.global/92297865-8423-4fe1-928c-10e45fd760d7/Death%20Note.jpg?v=1749799016263", title: "Death Note", description: "Un lycéen découvre un carnet qui tue les gens dont il écrit le nom à l'intérieur." },
          { image: "https://cdn.glitch.global/92297865-8423-4fe1-928c-10e45fd760d7/Death%20Note.jpg?v=1749799016263", title: "Death Note", description: "Un lycéen découvre un carnet qui tue les gens dont il écrit le nom à l'intérieur." },
          { image: "https://cdn.glitch.global/92297865-8423-4fe1-928c-10e45fd760d7/Death%20Note.jpg?v=1749799016263", title: "Death Note", description: "Un lycéen découvre un carnet qui tue les gens dont il écrit le nom à l'intérieur." },
          { image: "https://cdn.glitch.global/92297865-8423-4fe1-928c-10e45fd760d7/Death%20Note.jpg?v=1749799016263", title: "Death Note", description: "Un lycéen découvre un carnet qui tue les gens dont il écrit le nom à l'intérieur." },
          { image: "https://cdn.glitch.global/92297865-8423-4fe1-928c-10e45fd760d7/Death%20Note.jpg?v=1749799016263", title: "Death Note", description: "Un lycéen découvre un carnet qui tue les gens dont il écrit le nom à l'intérieur." },
      ],
      "Matières préférées": [
        { image: "https://cdn.glitch.global/753b2206-8aec-499d-95ff-df1dc687ac0e/Solo%20Leveling.jpg?v=1749755167270", title: "Solo Leveling", description: "Après avoir été le plus faible des chasseurs, Sung Jin-woo découvre un mystérieux « journal de quête » qui lui permet de monter de niveau indépendamment des autres. Devenu le chasseur le plus puissant, il affronte des donjons et des êtres surnaturels pour protéger l’humanité." },
          { image: "https://cdn.glitch.global/753b2206-8aec-499d-95ff-df1dc687ac0e/Solo%20Leveling.jpg?v=1749755167270", title: "Solo Leveling", description: "Après avoir été le plus faible des chasseurs, Sung Jin-woo découvre un mystérieux « journal de quête » qui lui permet de monter de niveau indépendamment des autres. Devenu le chasseur le plus puissant, il affronte des donjons et des êtres surnaturels pour protéger l’humanité." },
          { image: "https://cdn.glitch.global/753b2206-8aec-499d-95ff-df1dc687ac0e/Solo%20Leveling.jpg?v=1749755167270", title: "Solo Leveling", description: "Après avoir été le plus faible des chasseurs, Sung Jin-woo découvre un mystérieux « journal de quête » qui lui permet de monter de niveau indépendamment des autres. Devenu le chasseur le plus puissant, il affronte des donjons et des êtres surnaturels pour protéger l’humanité." },
          { image: "https://cdn.glitch.global/753b2206-8aec-499d-95ff-df1dc687ac0e/Solo%20Leveling.jpg?v=1749755167270", title: "Solo Leveling", description: "Après avoir été le plus faible des chasseurs, Sung Jin-woo découvre un mystérieux « journal de quête » qui lui permet de monter de niveau indépendamment des autres. Devenu le chasseur le plus puissant, il affronte des donjons et des êtres surnaturels pour protéger l’humanité." },
          { image: "https://cdn.glitch.global/753b2206-8aec-499d-95ff-df1dc687ac0e/Solo%20Leveling.jpg?v=1749755167270", title: "Solo Leveling", description: "Après avoir été le plus faible des chasseurs, Sung Jin-woo découvre un mystérieux « journal de quête » qui lui permet de monter de niveau indépendamment des autres. Devenu le chasseur le plus puissant, il affronte des donjons et des êtres surnaturels pour protéger l’humanité." },
          { image: "https://cdn.glitch.global/753b2206-8aec-499d-95ff-df1dc687ac0e/Solo%20Leveling.jpg?v=1749755167270", title: "Solo Leveling", description: "Après avoir été le plus faible des chasseurs, Sung Jin-woo découvre un mystérieux « journal de quête » qui lui permet de monter de niveau indépendamment des autres. Devenu le chasseur le plus puissant, il affronte des donjons et des êtres surnaturels pour protéger l’humanité." },
          { image: "https://cdn.glitch.global/753b2206-8aec-499d-95ff-df1dc687ac0e/Solo%20Leveling.jpg?v=1749755167270", title: "Solo Leveling", description: "Après avoir été le plus faible des chasseurs, Sung Jin-woo découvre un mystérieux « journal de quête » qui lui permet de monter de niveau indépendamment des autres. Devenu le chasseur le plus puissant, il affronte des donjons et des êtres surnaturels pour protéger l’humanité." },
          { image: "https://cdn.glitch.global/753b2206-8aec-499d-95ff-df1dc687ac0e/Solo%20Leveling.jpg?v=1749755167270", title: "Solo Leveling", description: "Après avoir été le plus faible des chasseurs, Sung Jin-woo découvre un mystérieux « journal de quête » qui lui permet de monter de niveau indépendamment des autres. Devenu le chasseur le plus puissant, il affronte des donjons et des êtres surnaturels pour protéger l’humanité." },
          { image: "https://cdn.glitch.global/753b2206-8aec-499d-95ff-df1dc687ac0e/Solo%20Leveling.jpg?v=1749755167270", title: "Solo Leveling", description: "Après avoir été le plus faible des chasseurs, Sung Jin-woo découvre un mystérieux « journal de quête » qui lui permet de monter de niveau indépendamment des autres. Devenu le chasseur le plus puissant, il affronte des donjons et des êtres surnaturels pour protéger l’humanité." },
      ]};
      // set up du tournoi
             let selectedCategory = "All-Time";
  let currentRound = [];
  let winners = [];
  let pairIndex = 0;
  let roundNumber = 1;
  let totalRounds = 0;

  const card1 = document.getElementById('card1');
  const card2 = document.getElementById('card2');
  const roundIndicator = document.getElementById('roundIndicator');
  const categoryElements = document.querySelectorAll('.category');
  const cardContainer = document.querySelector('.card-container');

  function normalizeCategory(cat) {
    return cat.trim().toLowerCase();
  }

  function shuffleArray(array) {
    for (let i = array.length - 1; i > 0; i--) {
      const j = Math.floor(Math.random() * (i + 1));
      [array[i], array[j]] = [array[j], array[i]];
    }
  }

  function updateRoundIndicator() {
    roundIndicator.textContent = `Round ${roundNumber} sur ${totalRounds} (${currentRound.length} participants)`;
  }

  async function loadPair() {
  console.log("loadPair appelé, winners.length :", winners.length, "winners :", winners);
  if (pairIndex < currentRound.length - 1) {
    const leftManga = currentRound[pairIndex];
    const rightManga = currentRound[pairIndex + 1];
    card1.innerHTML = `
      <img src="${leftManga.image}" alt="${leftManga.title}">
      <div class="info">
        <h2>${leftManga.title}</h2>
        <p>${leftManga.description}</p>
      </div>
    `;
    card2.innerHTML = `
      <img src="${rightManga.image}" alt="${rightManga.title}">
      <div class="info">
        <h2>${rightManga.title}</h2>
        <p>${rightManga.description}</p>
      </div>
    `;
  } else {
    if (winners.length === 1) {
      console.log("Fin du tournoi atteinte, gagnant :", winners[0], "title :", winners[0].title);
    
  document.body.classList.add('victory-background');
  document.body.innerHTML = `
    <button class="btn-finish">← Retour immédiat</button>
    <div class="winner">
      <h1>🏆 Manga Gagnant 🏆</h1>
      <h2>${winners[0].title}</h2>
      <img src="${winners[0].image}" alt="${winners[0].title}" class="winner-img">
      <p>${winners[0].description}</p>
      <p class="compte-rebours">Retour à l'accueil dans <span id="countdown">10</span> secondes...</p>
      <button id="btn-stats" class="gradient-button">📊 Accéder aux Statistiques</button>
    </div>
  `;

  document.getElementById('btn-stats').addEventListener('click', () => {
    window.location.href = 'statistiques.html';
  });

  let seconds = 10;
  const countdownEl = document.getElementById("countdown");
  const timer = setInterval(() => {
    seconds--;
    countdownEl.textContent = seconds;
    if (seconds <= 0) {
      clearInterval(timer);
      window.location.href = "Manga.html";
    }
  }, 1000);

  document.querySelector('.btn-finish').addEventListener('click', () => {
    clearInterval(timer);
    window.location.href = "Manga.html";
  });

      } else {
        currentRound = winners;
        winners = [];
        pairIndex = 0;
        roundNumber++;
        shuffleArray(currentRound);
        updateRoundIndicator();
        loadPair();
      }
    }
  }

  function chooseWinner(index) {
    winners.push(currentRound[pairIndex + index]);
    pairIndex += 2;
    loadPair();
  }

  function initializeTournament() {
    const keys = Object.keys(categoriesData);
    const foundKey = keys.find(k => normalizeCategory(k) === normalizeCategory(selectedCategory));

    if (foundKey && categoriesData[foundKey].length > 0) {
      currentRound = [...categoriesData[foundKey]];
      totalRounds = Math.log2(currentRound.length);
      if (!Number.isInteger(totalRounds)) {
        const validLength = Math.pow(2, Math.floor(totalRounds));
        currentRound = currentRound.slice(0, validLength);
        totalRounds = Math.floor(totalRounds);
      }
      shuffleArray(currentRound);
      winners = [];
      pairIndex = 0;
      roundNumber = 1;
      updateRoundIndicator();
      loadPair();
    } else {
      cardContainer.innerHTML = `<div class="winner"><h2>Aucun choix pour cette catégorie.</h2></div>`;
      roundIndicator.textContent = '';
    }
  }

  categoryElements.forEach(elem => {
    elem.addEventListener('click', () => {
      categoryElements.forEach(e => e.classList.remove('selected'));
      elem.classList.add('selected');
      selectedCategory = elem.getAttribute('data-category');
      initializeTournament();
    });
  });

  const urlParams = new URLSearchParams(window.location.search);
  const categoryParam = urlParams.get('category');
  if (categoryParam) {
    selectedCategory = categoryParam;
    categoryElements.forEach(e => e.classList.remove('selected'));
    const targetCat = Array.from(categoryElements).find(c => normalizeCategory(c.dataset.category) === normalizeCategory(categoryParam));
    if (targetCat) targetCat.classList.add('selected');
  }

  card1.addEventListener('click', () => chooseWinner(0));
  card2.addEventListener('click', () => chooseWinner(1));

  initializeTournament();
});
    </script>
  
  </body>
  </html>
